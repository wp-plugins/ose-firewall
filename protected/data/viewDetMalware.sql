CREATE VIEW `#__osefirewall_detmalware` AS 
SELECT m . * , f.filename, f.ext, checked, v.type_id, v.confidence, vt.type
FROM `#__osefirewall_malware` AS m
LEFT JOIN `#__osefirewall_files` AS f ON f.id = m.file_id
LEFT JOIN `#__osefirewall_vspatterns` AS v ON m.pattern_id = v.id
LEFT JOIN `#__osefirewall_vstypes` AS vt ON v.type_id = vt.id